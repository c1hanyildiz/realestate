<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Highline Building Services - AI Booking Assistant</title>
    <meta name="description" content="Book cleaning and maintenance services with our AI-powered chatbot. Deep cleaning, office walkthroughs, pressure washing, and graffiti removal.">
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .chat-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .message-bubble {
            max-width: 80%;
            word-wrap: break-word;
            animation: fadeInUp 0.3s ease-out;
        }
        
        .user-message {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            margin-left: auto;
            border-radius: 18px 18px 4px 18px;
        }
        
        .bot-message {
            background: #f8f9fa;
            color: #2c3e50;
            border: 1px solid #e9ecef;
            border-radius: 18px 18px 18px 4px;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f8f9fa;
            border-radius: 18px 18px 18px 4px;
            border: 1px solid #e9ecef;
            max-width: fit-content;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #6c757d;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .service-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .service-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .input-container {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            padding: 4px;
            transition: border-color 0.3s ease;
        }
        
        .input-container:focus-within {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .send-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .send-button:hover {
            transform: scale(1.05);
        }
        
        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="bg-white/10 backdrop-blur-md border-b border-white/20">
        <div class="max-w-4xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                        <i data-lucide="building" class="w-5 h-5 text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-white font-semibold">Highline Building Services</h1>
                        <p class="text-white/70 text-sm">AI Booking Assistant</p>
                    </div>
                </div>
                <a href="../index.html" class="text-white/70 hover:text-white transition-colors">
                    <i data-lucide="arrow-left" class="w-5 h-5"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Main Chat Interface -->
    <div class="max-w-4xl mx-auto px-6 py-8">
        <div class="chat-container rounded-3xl overflow-hidden">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center">
                        <i data-lucide="bot" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900">Highline Assistant</h3>
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                            <span class="text-sm text-gray-600">Online</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="h-96 overflow-y-auto p-6 space-y-4 bg-white">
                <!-- Initial bot message -->
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center flex-shrink-0">
                        <i data-lucide="bot" class="w-4 h-4 text-white"></i>
                    </div>
                    <div class="message-bubble bot-message p-4">
                        <p class="text-sm">Hey there! ðŸ‘‹ Need a deep clean, office walkthrough, pressure wash, or graffiti removal? I'll get you scheduled with our comprehensive intake process.</p>
                    </div>
                </div>
            </div>

            <!-- Service Selection Buttons -->
            <div id="service-buttons" class="px-6 pb-4">
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="selectService('Deep Cleaning')" class="service-button text-sm">
                        <i data-lucide="sparkles" class="w-4 h-4 inline mr-2"></i>
                        Deep Cleaning
                    </button>
                    <button onclick="selectService('Office Walkthrough')" class="service-button text-sm">
                        <i data-lucide="clipboard-check" class="w-4 h-4 inline mr-2"></i>
                        Office Walkthrough
                    </button>
                    <button onclick="selectService('Pressure Washing')" class="service-button text-sm">
                        <i data-lucide="droplets" class="w-4 h-4 inline mr-2"></i>
                        Pressure Washing
                    </button>
                    <button onclick="selectService('Graffiti Removal')" class="service-button text-sm">
                        <i data-lucide="paint-brush" class="w-4 h-4 inline mr-2"></i>
                        Graffiti Removal
                    </button>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="p-6 pt-0">
                <div class="input-container flex items-center space-x-3">
                    <input 
                        type="text" 
                        id="chat-input" 
                        placeholder="Type your message..." 
                        class="flex-1 bg-transparent border-none outline-none px-4 py-3 text-gray-900 placeholder-gray-500"
                        onkeypress="handleKeyPress(event)"
                    >
                    <button onclick="sendMessage()" id="send-button" class="send-button">
                        <i data-lucide="send" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Info Panel -->
        <div class="mt-8 bg-white/10 backdrop-blur-md rounded-2xl p-6 text-white">
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="clock" class="w-6 h-6"></i>
                    </div>
                    <h4 class="font-semibold mb-1">24/7 Booking</h4>
                    <p class="text-sm text-white/70">Schedule anytime, get confirmed within 2 hours</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="shield-check" class="w-6 h-6"></i>
                    </div>
                    <h4 class="font-semibold mb-1">Fully Insured</h4>
                    <p class="text-sm text-white/70">Licensed, bonded, and insured for your peace of mind</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="phone" class="w-6 h-6"></i>
                    </div>
                    <h4 class="font-semibold mb-1">Need Help?</h4>
                    <p class="text-sm text-white/70">Call (917) 535-3787 for urgent requests</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Chat state
        let chatStep = 0;
        let bookingData = {};
        let serviceSpecificStep = 0;
        let currentService = '';

        // Handle Enter key press
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Send message function
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            addUserMessage(message);
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            setTimeout(() => {
                hideTypingIndicator();
                processChatMessage(message);
            }, 1000 + Math.random() * 1000); // Random delay for realism
        }

        // Add user message
        function addUserMessage(message) {
            const container = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-end';
            messageDiv.innerHTML = `
                <div class="message-bubble user-message p-4">
                    <p class="text-sm">${message}</p>
                </div>
            `;
            container.appendChild(messageDiv);
            scrollToBottom();
        }

        // Add bot message
        function addBotMessage(message) {
            const container = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex items-start space-x-3';
            messageDiv.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <i data-lucide="bot" class="w-4 h-4 text-white"></i>
                </div>
                <div class="message-bubble bot-message p-4">
                    <p class="text-sm">${message}</p>
                </div>
            `;
            container.appendChild(messageDiv);
            lucide.createIcons();
            scrollToBottom();
        }

        // Show typing indicator
        function showTypingIndicator() {
            const container = document.getElementById('chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'flex items-start space-x-3';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center flex-shrink-0">
                    <i data-lucide="bot" class="w-4 h-4 text-white"></i>
                </div>
                <div class="typing-indicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            container.appendChild(typingDiv);
            lucide.createIcons();
            scrollToBottom();
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // Scroll to bottom
        function scrollToBottom() {
            const container = document.getElementById('chat-messages');
            container.scrollTop = container.scrollHeight;
        }

        // Select service
        function selectService(service) {
            addUserMessage(service);
            bookingData.service = service;
            currentService = service;
            
            // Hide service buttons
            document.getElementById('service-buttons').style.display = 'none';
            
            showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator();
                addBotMessage(`Great choice! ${service} it is. Let's start with your company name.`);
                chatStep = 1;
                serviceSpecificStep = 0;
            }, 1500);
        }

        // Process chat messages
        function processChatMessage(message) {
            switch(chatStep) {
                case 1:
                    bookingData.company = message;
                    addBotMessage(`Perfect, ${message}! What's your contact name?`);
                    chatStep = 2;
                    break;
                case 2:
                    bookingData.contact = message;
                    addBotMessage(`Nice to meet you, ${message}! What's your business email address? (Note: We require business domains)`);
                    chatStep = 3;
                    break;
                case 3:
                    bookingData.email = message;
                    if (isPersonalEmail(message)) {
                        addBotMessage(`I notice that's a personal email domain. We typically require business emails, but I can make a note for admin review. What's your phone number?`);
                    } else {
                        addBotMessage(`Great! What's your phone number?`);
                    }
                    chatStep = 4;
                    break;
                case 4:
                    bookingData.phone = message;
                    addBotMessage(`Thanks! Now I need the full service location address including street, city, state, ZIP, and if applicable - building name, floor, and suite number.`);
                    chatStep = 5;
                    break;
                case 5:
                    bookingData.address = message;
                    addBotMessage(`Perfect! Any general notes about the job or special access instructions?`);
                    chatStep = 6;
                    break;
                case 6:
                    bookingData.notes = message;
                    addBotMessage(`Great! Please upload up to 5 photos (clear, well-lit): Wide shot of the full area, closer detail shots, access points, and any obstacles. You can describe them for this demo.`);
                    chatStep = 7;
                    break;
                case 7:
                    bookingData.photos = message;
                    addBotMessage(`Perfect! Now I need some specific details about your ${currentService} service. Let me ask you a few targeted questions...`);
                    chatStep = 8;
                    serviceSpecificStep = 1;
                    setTimeout(() => {
                        showTypingIndicator();
                        setTimeout(() => {
                            hideTypingIndicator();
                            askServiceSpecificQuestions();
                        }, 1000);
                    }, 1500);
                    break;
                case 8:
                    handleServiceSpecificResponse(message);
                    break;
                case 9:
                    bookingData.preferredDateTime = message;
                    const bookingId = 'HL' + Math.random().toString(36).substr(2, 6).toUpperCase();
                    addBotMessage(`Excellent! ðŸŽ‰ Your ${bookingData.service} request for ${bookingData.company} is now complete and pending review. 

Booking ID: ${bookingId}

You'll receive an email confirmation shortly, and we'll get back to you within 2 hours with approval and next steps. 

Need something urgent? Call (917) 535-3787 and mention your booking ID.

Thanks for choosing Highline Building Services!`);
                    chatStep = 0;
                    serviceSpecificStep = 0;
                    
                    // Show restart option
                    setTimeout(() => {
                        addBotMessage(`Would you like to book another service? Just click one of the service buttons below!`);
                        document.getElementById('service-buttons').style.display = 'block';
                    }, 3000);
                    break;
                default:
                    addBotMessage("I'd be happy to help you schedule a service! Please select one of the service options above to get started with our comprehensive intake process.");
            }
        }

        // Service-specific questions
        function askServiceSpecificQuestions() {
            switch(currentService) {
                case 'Deep Cleaning':
                    switch(serviceSpecificStep) {
                        case 1:
                            addBotMessage("What's the approximate square footage of the space to be cleaned? (Must be between 300-200,000 sq ft)");
                            break;
                        case 2:
                            addBotMessage("What type of space is this? (office / medical / retail / industrial / mixed)");
                            break;
                        case 3:
                            addBotMessage("How many floors or levels need to be serviced?");
                            break;
                        case 4:
                            addBotMessage("What type of flooring? (carpet / VCT / LVT / stone / tile / mixed)");
                            break;
                        case 5:
                            addBotMessage("Is there a kitchen or break area? If yes, how many?");
                            break;
                        case 6:
                            addBotMessage("How many restrooms or fixtures need cleaning?");
                            break;
                        case 7:
                            addBotMessage("When was the last professional deep clean? (date or 'unknown')");
                            break;
                        case 8:
                            addBotMessage("Is after-hours cleaning acceptable? (yes/no)");
                            break;
                        case 9:
                            addBotMessage("Is a Certificate of Insurance (COI) required? If yes, please specify building requirements.");
                            break;
                        case 10:
                            addBotMessage("Please describe freight/loading dock access and hours.");
                            break;
                        case 11:
                            addBotMessage("Who will be the on-site contact day-of? (name + phone)");
                            break;
                        default:
                            addBotMessage("Finally, when would you like to schedule this? I have availability tomorrow at 2:00 PM, Friday at 10:00 AM, or Monday at 9:00 AM.");
                            chatStep = 9;
                    }
                    break;
                    
                case 'Office Walkthrough':
                    switch(serviceSpecificStep) {
                        case 1:
                            addBotMessage("What's the total approximate square footage of your office?");
                            break;
                        case 2:
                            addBotMessage("How many employees or daily occupancy does the space have?");
                            break;
                        case 3:
                            addBotMessage("What are your days and hours of operation?");
                            break;
                        case 4:
                            addBotMessage("Do you currently have a cleaning provider? If yes, what's the scope and any pain points?");
                            break;
                        case 5:
                            addBotMessage("Which areas should we prioritize? (reception, conference rooms, pantries, restrooms, executive offices, labs, etc.)");
                            break;
                        case 6:
                            addBotMessage("What are the security/access requirements? (badges, escort, COI needed?)");
                            break;
                        case 7:
                            addBotMessage("Any parking or loading notes for our team?");
                            break;
                        default:
                            addBotMessage("Perfect! When would you prefer the walkthrough? I have availability tomorrow at 2:00 PM, Friday at 10:00 AM, or Monday at 9:00 AM.");
                            chatStep = 9;
                    }
                    break;
                    
                case 'Pressure Washing':
                    switch(serviceSpecificStep) {
                        case 1:
                            addBotMessage("What type of surface needs pressure washing? (concrete / pavers / stone / brick / metal / other)");
                            break;
                        case 2:
                            addBotMessage("What's the area size? (square feet or linear feet)");
                            break;
                        case 3:
                            addBotMessage("What's the height? (ground-level only / up to 1 story / 2-3 stories / 4+ stories)");
                            break;
                        case 4:
                            addBotMessage("Is there a water source on site? (hose bib / interior hookup / none)");
                            break;
                        case 5:
                            addBotMessage("What power is available? (110V / 220V / generator needed)");
                            break;
                        case 6:
                            addBotMessage("Is there grease or oil present? (yes/no)");
                            break;
                        case 7:
                            addBotMessage("Are there any noise or time restrictions? (yes/no - if yes, please specify)");
                            break;
                        case 8:
                            addBotMessage("Will permits or scaffolding be needed? (yes/no/unknown)");
                            break;
                        default:
                            addBotMessage("Great! When would you like to schedule the pressure washing? I have availability tomorrow at 2:00 PM, Friday at 10:00 AM, or Monday at 9:00 AM.");
                            chatStep = 9;
                    }
                    break;
                    
                case 'Graffiti Removal':
                    switch(serviceSpecificStep) {
                        case 1:
                            addBotMessage("What's the substrate/surface? (painted wall / brick / stone / metal / glass / other)");
                            break;
                        case 2:
                            addBotMessage("What's the coating type? (sealed / unsealed / unknown)");
                            break;
                        case 3:
                            addBotMessage("What's the coverage area (sq ft) and height from ground (ft)?");
                            break;
                        case 4:
                            addBotMessage("Is the graffiti fresh or aged? (â‰¤72hrs / >72hrs / unknown)");
                            break;
                        case 5:
                            addBotMessage("Are there sensitive areas or landmark review requirements? (yes/no)");
                            break;
                        case 6:
                            addBotMessage("Is there a water source available? (yes/no)");
                            break;
                        case 7:
                            addBotMessage("Is after-hours work acceptable? (yes/no)");
                            break;
                        case 8:
                            addBotMessage("Please ensure your photos include close-ups and wide shots of the graffiti area. Are your photos comprehensive?");
                            break;
                        default:
                            addBotMessage("Perfect! When would you like to schedule the graffiti removal? I have availability tomorrow at 2:00 PM, Friday at 10:00 AM, or Monday at 9:00 AM.");
                            chatStep = 9;
                    }
                    break;
            }
        }

        // Handle service-specific responses
        function handleServiceSpecificResponse(message) {
            // Store the response
            if (!bookingData.serviceSpecific) {
                bookingData.serviceSpecific = {};
            }
            bookingData.serviceSpecific[`step${serviceSpecificStep}`] = message;
            
            // Validation and special handling
            if (currentService === 'Deep Cleaning' && serviceSpecificStep === 1) {
                const sqft = parseInt(message);
                if (sqft < 300 || sqft > 200000) {
                    addBotMessage("Please enter a square footage between 300 and 200,000 sq ft.");
                    return;
                }
                if (sqft >= 20000) {
                    addBotMessage("Got it! For large spaces like this, we may recommend multiple crews. Continuing...");
                }
            }
            
            if (currentService === 'Pressure Washing' && serviceSpecificStep === 3) {
                if (message.includes('2-3 stories') || message.includes('4+ stories')) {
                    addBotMessage("Noted! Access planning (boom/scaffold) may be required for elevated work. Continuing...");
                }
            }
            
            if (currentService === 'Graffiti Removal' && serviceSpecificStep === 1) {
                if (message.toLowerCase().includes('landmark')) {
                    addBotMessage("Important! Landmark approval may be required. Our admin will verify this. Continuing...");
                }
            }
            
            serviceSpecificStep++;
            
            showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator();
                askServiceSpecificQuestions();
            }, 1000);
        }

        // Check if email is personal domain
        function isPersonalEmail(email) {
            const personalDomains = ['gmail.com', 'yahoo.com', 'outlook.com', 'hotmail.com', 'aol.com'];
            const domain = email.split('@')[1];
            return personalDomains.includes(domain?.toLowerCase());
        }
    </script>
</body>
</html>